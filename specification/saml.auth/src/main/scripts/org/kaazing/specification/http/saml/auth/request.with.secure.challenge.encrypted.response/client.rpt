#
# Copyright 2007-2015, Kaazing Corporation. All rights reserved.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

property location 'http://localhost:8080/echo'
property key ${ws:handshakeKey()}
property client125 ${ws:randomBytes(125)}

property challenge "Basic realm=\"demo\" saml-authn-request=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"

connect ${location}
connected

write method "GET"
write version "HTTP/1.1"
write header host
write header "Upgrade" "websocket"
write header "Connection" "Upgrade"
write header "Sec-WebSocket-Key" ${key}
write header "Sec-WebSocket-Version" "13"


read status "401" "Unauthorized"
read header "WWW-Authenticate" ${challenge} 
read notify FIRST_REQUEST_COMPLETE

connect await FIRST_REQUEST_COMPLETE
connect ${location}
connected

write method "GET"
write version "HTTP/1.1"
write header host
write header "Upgrade" "websocket"
write header "Authorization" "Basic realm=\"demo\" saml-authn-request=\"PHNhbWwycDpSZXNwb25zZSB4bWxuczpzYW1sMnA9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpwcm90b2NvbCIgRGVzdGluYXRpb249Imh0dHBzOi8vaWRwdGVzdGJlZC9TaGliYm9sZXRoLnNzby9TQU1MMi9FQ1AiIElEPSJfZWVmNGNjOTUwYzY1OWI4NjU3YjE1ZjlhODNiNDA3MWYiIEluUmVzcG9uc2VUbz0iX2UyMDFiYTk5OTlmNGE0NDI3ODBmNWUxZWUxYmNkYmJhIiBJc3N1ZUluc3RhbnQ9IjIwMTYtMTItMzBUMTc6MTQ6NTguMTUwWiIgVmVyc2lvbj0iMi4wIj48c2FtbDI6SXNzdWVyIHhtbG5zOnNhbWwyPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIj5odHRwczovL2lkcHRlc3RiZWQvaWRwL3NoaWJib2xldGg8L3NhbWwyOklzc3Vlcj48ZHM6U2lnbmF0dXJlIHhtbG5zOmRzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIj4NCjxkczpTaWduZWRJbmZvPg0KPGRzOkNhbm9uaWNhbGl6YXRpb25NZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biMiLz4NCjxkczpTaWduYXR1cmVNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNyc2Etc2hhNTEyIi8+DQo8ZHM6UmVmZXJlbmNlIFVSST0iI19lZWY0Y2M5NTBjNjU5Yjg2NTdiMTVmOWE4M2I0MDcxZiI+DQo8ZHM6VHJhbnNmb3Jtcz4NCjxkczpUcmFuc2Zvcm0gQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjZW52ZWxvcGVkLXNpZ25hdHVyZSIvPg0KPGRzOlRyYW5zZm9ybSBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIvPg0KPC9kczpUcmFuc2Zvcm1zPg0KPGRzOkRpZ2VzdE1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI3NoYTUxMiIvPg0KPGRzOkRpZ2VzdFZhbHVlPllPMkNOcUJkTnFkcUdlZkNockk2SlFqS1B0M0tZbFprNU5BT203RkpaTmxrMm1jZWVWb1hYQzlQUTFNQXZGQ2UxQTcyNC9aWHhod3gNCnJ5Ni8xaTRjbGc9PTwvZHM6RGlnZXN0VmFsdWU+DQo8L2RzOlJlZmVyZW5jZT4NCjwvZHM6U2lnbmVkSW5mbz4NCjxkczpTaWduYXR1cmVWYWx1ZT4NCmU0K1YwNzhIZUlXanBwOFVXK1YxU0lTOHVnbm8renFtdGNyNWY0Z3Z1OHZmb2gxWk1PaGxrT3RQRzE0YU1XMVZIdmpGSkhRZXVGRDkNClhYSjN1UXJEZmx0RTh4K1crVUgzU3FFaFFCVWErSnFpaEwwTFk1ZE1RWHQ0QlVBVU5DOEQ3bnNOTGVNS3hNWTRWRG92RDFsTkI2akYNCllkcDd1a0lCczgyTjhYeUZPNFBwU3QvcXp2bXhReUFTZ0RyRVZ5QnRmWWZ2ejlZZ0M4MzBPbGg3bEcwZFZBRDgvbzNZYXUyK3M0djENCjk1bHdYNWxwZGVCeWl3SUFWdEFDQmNkN2R2RGVWcGZkZ3ZqRlVaTWczNEh3MkkxY3FLVXlZSnJsMWVGL0RaMXgwOW9pbFlZMi9WVDcNCkZuVVp0Q1BoNTdCQlpKZm42N3lkU29FcUdSSzFPSVh5aUdTRDV3PT0NCjwvZHM6U2lnbmF0dXJlVmFsdWU+DQo8ZHM6S2V5SW5mbz48ZHM6WDUwOURhdGE+PGRzOlg1MDlDZXJ0aWZpY2F0ZT5NSUlERkRDQ0FmeWdBd0lCQWdJVkFOM3Z2K2I3S041U2U5bTFSWnNDbGxwL0IvaGRNQTBHQ1NxR1NJYjNEUUVCQ3dVQU1CVXhFekFSDQpCZ05WQkFNTUNtbGtjSFJsYzNSaVpXUXdIaGNOTVRVeE1qRXhNREl5TURFMFdoY05NelV4TWpFeE1ESXlNREUwV2pBVk1STXdFUVlEDQpWUVFEREFwcFpIQjBaWE4wWW1Wa01JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBaDkxY2FlWTBRODV1DQpoYVV5cUZ3UDJiTWp3TUZ4TXpSbEFvcUJIZDdndTZlbzRkdWFlTHoxQmFvUjJYVEJwTk52RlI1b0hIK1RrS2FoVkRHZUg1K2tjbklwDQp4SThKUGRzWm1sMXNydmYyWjZkekpzdWxKWlVkcHFubmd5Y1RrR3RaZ0VvQzF2bVlWa3kyQlNBSUlpZm1kaDZzMGVwYkhuTUdMc0h6DQpNS2ZKQ2IvUTZkWXpSV1RDUHR6RTJWTXVRcXFXZ2V5TXI3dTE0eC9WcXI5UlBFRnNnWThHSXU1anpCNkF5VUl3ckxnK01Oa3Y2YUlkDQpjSHd4WVRHTDdpamZ5NnJTV3JnQmZsUW9ZUllORW5zZUswWkhnSmFoejRvdkNhZzZ3WkFvUHBCc3VZbFk3bEVyODlVY2I2Tkh4M3VxDQpHTXNYbERGZEU0UXdmRExMaENZSFB2SjB1d0lEQVFBQm8xc3dXVEFkQmdOVkhRNEVGZ1FVQWtPZ0VEM2lZZG12UUVPTW02dS9KbUQvDQpVVFF3T0FZRFZSMFJCREV3TDRJS2FXUndkR1Z6ZEdKbFpJWWhhSFIwY0hNNkx5OXBaSEIwWlhOMFltVmtMMmxrY0M5emFHbGlZbTlzDQpaWFJvTUEwR0NTcUdTSWIzRFFFQkN3VUFBNElCQVFCSWRkNFlXbG52SmpxbDgrektLZ21XZ0lZN1U4REE4ZTZRY2JBZjhmOGNkRTMzDQpSU25qSTYzWHN2L3k5R2ZtYkFWQUQ2UklBWFBGRmVSWUowOEdPeEdJOWF4Zk5hS2Rsc2tsSjliazRkdWNIcWdDU1dZVmVyM3NSUUJqDQp4eU9mU1R2azlZQ0p2ZEpWUVJKTGNDdnh3S2FrRkNzT1NuVjN0OU92Tjg2QWsrZktQVkI1ajJmTS8wZlpLcWpuM2lxZ2ROUFRMWFBzDQp1SkxKTzVsSVRSaUJhNG9ubVZlbEFpQ3N0STlQUWlhRWNrK29BSG5NVG5DOUpFL0JESHYzZTRyd3EzTHpubHFQdzBHU2Q3eHFOVGRNDQpEd05PV2prdU9yM3NHcFdTOG1zL1pISFhWMVZkMjJ1UGU3MGlzMDB4cnYxNHpMaWZjYzhvajVEWXpPaFlSaWZSWGdIWDwvZHM6WDUwOUNlcnRpZmljYXRlPjwvZHM6WDUwOURhdGE+PC9kczpLZXlJbmZvPjwvZHM6U2lnbmF0dXJlPjxzYW1sMnA6U3RhdHVzPjxzYW1sMnA6U3RhdHVzQ29kZSBWYWx1ZT0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnN0YXR1czpTdWNjZXNzIi8+PC9zYW1sMnA6U3RhdHVzPjxzYW1sMjpFbmNyeXB0ZWRBc3NlcnRpb24geG1sbnM6c2FtbDI9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iPjx4ZW5jOkVuY3J5cHRlZERhdGEgeG1sbnM6eGVuYz0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxlbmMjIiBJZD0iXzQxYjllMGQ0MmY1MDM0YTVkNWMwYjk2NTM4MWQwNjJiIiBUeXBlPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGVuYyNFbGVtZW50Ij48eGVuYzpFbmNyeXB0aW9uTWV0aG9kIHhtbG5zOnhlbmM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jIyIgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDA5L3htbGVuYzExI2FlczEyOC1nY20iLz48ZHM6S2V5SW5mbyB4bWxuczpkcz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyI+PHhlbmM6RW5jcnlwdGVkS2V5IHhtbG5zOnhlbmM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jIyIgSWQ9Il82Y2QxYmE1MDgyNjY2OGM4MjE5OTE3NmEwMzRlYTJjNSIgUmVjaXBpZW50PSJodHRwczovL3NwLmlkcHRlc3RiZWQvc2hpYmJvbGV0aCI+PHhlbmM6RW5jcnlwdGlvbk1ldGhvZCB4bWxuczp4ZW5jPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGVuYyMiIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwOS94bWxlbmMxMSNyc2Etb2FlcCI+PGRzOkRpZ2VzdE1ldGhvZCB4bWxuczpkcz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyIgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjc2hhMSIvPjx4ZW5jMTE6TUdGIHhtbG5zOnhlbmMxMT0iaHR0cDovL3d3dy53My5vcmcvMjAwOS94bWxlbmMxMSMiIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwOS94bWxlbmMxMSNtZ2Yxc2hhMSIvPjwveGVuYzpFbmNyeXB0aW9uTWV0aG9kPjxkczpLZXlJbmZvPjxkczpYNTA5RGF0YT48ZHM6WDUwOUNlcnRpZmljYXRlPk1JSUM2ekNDQWRPZ0F3SUJBZ0lKQU95MG5raTNXQU9WTUEwR0NTcUdTSWIzRFFFQkJRVUFNQmN4RlRBVEJnTlZCQU1URERjNU9UUXoNClptVmxOemcyTlRBZUZ3MHhOVEV5TVRFd016QXdOREphRncweU5URXlNRGd3TXpBd05ESmFNQmN4RlRBVEJnTlZCQU1URERjNU9UUXoNClptVmxOemcyTlRDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTFBCekF6MERUbitqMllzUUtmcVdJK20NCjA4bFA1VXp3VnNFOVpLekxxTzNQUkhacWlPQm1FYUZtUnJZQ1pDQU9jSjBUWGN4UEd0TlNvOEhDNHV3NS9ZNWxKR3VJM2pON1g3S0INCjFWVVFEcFVTd2ZnT3F0cm91RG9WUktyc2FZWlRubE5WOEtiWjBXUXo1czRVdzZDeEtSQjlSWjVpUU1QMWZ1eGM4QjZHU09iM3g2OU0NCmlZNmMxamxnVkFjNnJWNHpHZnBhZmFjeE9MTThxY1loWTh1M1RpU2QwSCtvaUdFcWkxbUZMSzh5cDZGS3pYOE9Va1FmV2U0OVlIejYNCndCeEZPZSsvcCs3eml5bTFyQnMvbEdmZW5Fbzh6aUNJTW1qbm9vMjU3ZnowMGJjejlyRmwxclR4S0xGZmd5NzJ4VGxHNzJsNnUrcEINCjlWcUszWU5KUzUyTnM1VUNBd0VBQWFNNk1EZ3dGd1lEVlIwUkJCQXdEb0lNTnprNU5ETm1aV1UzT0RZMU1CMEdBMVVkRGdRV0JCUmkNCkRNTlBqaUFNQzUwV1d1YkkzUE1qUDQ1Uy9EQU5CZ2txaGtpRzl3MEJBUVVGQUFPQ0FRRUFZWk0vaVdnQzkzdkFxMGQ5OGVnRXp2RVMNCktvZHhIZmZrRE9hZ2Q0S3h0L1MwQUFIc1ZRQ21BSy85a21SaHNXelIzZjFLSXc5OHE0RVg3bkgvSzY4QkZyZXJVdmFMNStmRUdFOVcNCjZLaTZRZFc4Yk0xN0dRa0x5UkRLWnpHUG0vaHNhRzFPeHJ1MmtEZjdxU3Z2NTlhUlpsWjhza3JERW54OCtkWjhKS0MwMlpEVUNsQysNCnhXbDFVUGZPMkJMNHRKZWkvc2lTeW1HcGlScXpuUTJKTW9URnU1Q1VVcG94eUNWejFibDlsQ1ZjZW9KOUZhTDM4a25TMHA1RG5YY20NCitJOHdxTkVWR0xEUGJEYWxCUXJ5aEpUOWZJTW0xL0I4NWdCM0FXQXZjdTlQUGZIS2xRUVVoeHlFWFRCSngzbHVMbHBJam9sb0ZLSXUNCnRlOUs3cEU1cUFFTmpnPT08L2RzOlg1MDlDZXJ0aWZpY2F0ZT48L2RzOlg1MDlEYXRhPjwvZHM6S2V5SW5mbz48eGVuYzpDaXBoZXJEYXRhIHhtbG5zOnhlbmM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jIyI+PHhlbmM6Q2lwaGVyVmFsdWU+bnJqcmhiaUZ5MkI4eHRGNTh4a1N6NE9abEpLeExxOW5ESktNSUV5cnljd05pdHJpMFBERFJOWHJ4VmQyM3lDWG1oVzF4eENkWlIrbw0KZVVLNXZkTmtRL3dVTXNLSXR3MWJnU201S0lCZGRqYXdXVG1PQzFwbGJ2SW9pWlhFT05XaVQzTEtja1REWnUxN0QrTmdzaWVtMXZJTQ0KMDFXTHdwZzVvZDVMS0RUWEtLek1YUW40WDVYSDdrRU05UUZBUjZNNkdkVTlQMkhPR2xhb29vOGR2aktITW1zVm1qNDBNWlVaSEl4Zg0Ka3FpNVV1MEpBUDVZc0FJRi9SczJpOTdmbTFPZjdwZ3JNREszUUhOYUpyckcwVWVRT29NMlFKcVBwcFNCQ0NBMFdTSzh4d2I3aTRENg0KOU43M1hIQk9pUnFKOHBuS0d0TFpENzJROVdYcjlTVXQxK2dZa2c9PTwveGVuYzpDaXBoZXJWYWx1ZT48L3hlbmM6Q2lwaGVyRGF0YT48L3hlbmM6RW5jcnlwdGVkS2V5PjwvZHM6S2V5SW5mbz48eGVuYzpDaXBoZXJEYXRhIHhtbG5zOnhlbmM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jIyI+PHhlbmM6Q2lwaGVyVmFsdWU+WmxWbURxZlgrUG03ZVhJTE9FdHVTVVg2R1NSOVVCMmJVbS95bzlOOXA5eTFzZjJEVEcyeHplRFNrZkdzTnU4cnliZ25SRGFUVFhyVA0KeW5WZ1Z4QTZrN0hRWUVxSmlsd2lJc1RCZ1MyRUFaMWtDS0FkczAxdG1tOENKZDFTQUg1L0tYNXNHeHRzZlp0L3krR3BsZDA4dnExOQ0Kc3F0S3MzcG10aGpTaFJ4Vlp1YmJwQnlQRmpKRU9mOEkyd0NsZWtnT082eFgyRmhyTERMYytOU1RmTHZWTVAzRmRuMkRyemtQa2NXUQ0KaU5sYmdjM3lubW5Kcmg1UWRLRnBpandTT0VaYmdMaUJtanpxRExjZXBSQ3VNMmV2c1J6Q1B3cnF5U2FZK3ZQNm92V0VxWUdiYUZXVg0KZVRNQU04Z3NaZnVKQ0ZhbDZRTUsxSkt1elY1cWFqek1RRkhrbkZ0UHdaYUF4TzBHVnJVS25uRmM3OGN4M2lDclA1anB3VmV5bnVaQg0KODhOMEd2NmxGMGpDN3lBaXBUTmhDQ3lJVUJQeDdhVkZUblNOMU5RYXpxOHFJbVNocHNTSUFLT1F3NzVtNW95OHZjRkREQjhpS0Y3NA0KNFo4WkYrYytwS3dncEpWR0tzc2ZpY3hPb3lTdHFOdS9FRFhSSFo5SDl6MFNXY1JpeHpwRG5qVSszcVZ0eDhDTGJNTzNOZGdPVlZXMA0KU1hvRnltTlFQZ3BidTVpUnZKR3FJdkZMNGEvTXFyamt0Y0lkdnZCbjBjVUk3ZDVONWpNT2t0cXpsRFFaMnBYeDl0VUxsWW9vemE2Tg0KTTRpdkRKU05CMUxwUStQemd2cnhSYTJPQjZ4Vy9uV1BLQ0FFRFVtTGRWMnNVY05mUU1EbVV0WnZZNGhxM3lwMkc3QU5JQmVYMlZZdg0KNmVFNjRuNVJLV0dkemtzSU5RbDVaL3cyVitRZGpoMnNjV0FEdURQZWVodWVsVjVMQk5oL2drUFJTU3VORWZhVlI2V1BYRWxSNXRaaw0KUlI1ZERrS3RVMjR4eHBPS2JBREcwNWVnOWhNTFJsNnM5Sm42RTZWbk9idjlDQmR4T0pRZWJvWjFFYnUzWTdvZ3Npakc0eFVzZEhHSA0Kbks4R2RVa3JYWWV1WWxBTWdBbWV3UkJFdXgyaGJPamZ1WEhGK09uRmtOdGd2VE5xVGF5QnY3T3BLUWxtMHhidSt6ejgwRmp2dTMvZQ0KWU12R2RsU012VUtUU0hFV2ZTb2FYWlJPWmFxMG1PdVRKaS94S25iTHhNRDkxd00wMXlya0ExZEpIYmZoR2VrVHpZa0NvZlRwMnNHQw0KMHhHNjh3cVdFb0NRL3ZHdVhXM2oyVkpDcVZIRE1mZjA3S1c2bHhvZ3NNaC9XTjVsSGtQc0Z0LzhXZ1NVUjY2RkN2R01XMHRsZGg5WA0KR2lZbTRZVEluZnNVeTRMVWVSdmpwNVRlYmF5cVIxSGZSbXducTYyK1dGVC9jeEV1Yys1clVCWHkzUVV1K0N2TDZLeUF3bnYzZnMrYg0KNlc0VVRyZ1gyTDVUS1FWdEp6Y200UmJMc2FHVTVWYUJXMy94eHd0TjVJVFl2S1E3WlJuVU1EdHZaMUJoRWM2NlUvSlF4NWJxU0VwVg0KZHFtbVo0MkRYazhrcTBqd09aQVVxcEZqd3BoTU15OFRHeXhMRzl5Ym0zdkpncCtUL25iR3VuN2wxcHozZTFudFNiU0lDSStXOEE4Yw0KWWloTkVlTjFlMXZFcXRsTDEwOFJhdlFwNFlkd0F0WkZLbmpHeC9qMVhmNFhrTSs5Z3lHWDNBTFplNVVYd0hDNDdYSTZKV2lDajFoZw0KSlRhckJwRjYrZTdEUXB3bDJHN0pQOXI4a0JTVElaSzg5clYydlB2RkZuRXZ3bWV5dWNxQWtLbzlTK0I2ZnZnb1ZrNWF2dzNydDJ5RA0KRlEvWmxGdUQrNm4vTzdKdWhaRVd2cmhoUXJZR2RqTE5GYlh0NjBrcm55ZmZSa0UzUHZVYytPcEFlZWU0cTc4Uy9tMU9rUGNsaVhpNQ0KRjFFNXZQYVo5SGYvbUF1aTZWT1A1aW5FU0Z4dFdXaXlDdUdlSXNZdWN0VENCYzV5NG94T2NIOWZnU25IdlF4d3FxZE1BS1pDRExEeQ0KdTRpMGl6dytEOTE2Nk5aSXEwRkROQkFBQXcvTU8wZk9XTEFLMUVWMDRLOS85K05jek9rMXJPQTVEMzRQOHF5S0ovUzRUekNSckd4cQ0Kc3NDNk5laHBqQ2VIalIwWlRRaVFSMlRVQVNIWTJwb0xaY0YxaWFwRW1OZEQ5cWp2Um9GL0NGOHdybWZzWTRRUG14UEZjZEdZeDVPbw0KM3AzQU5LaHFQM1YvR1NaR3lwVTBGQkRpNFZKNzhnMGxaUjBKVlk5U1J6a3o0cGl2NHVkT3NTRkdnN2IvTGZ6dDE4UDlndXNjc0VIbg0KN0QrZTV2K1pxMnB2VUlSejhxY3ZOa1E4alZjSG44R1FUMWFacWxpSmZNdzFKeCs5dGxST2pNZExYeVhBbEdxaVpScUxWSExhYW8rWg0KTHUxOURWbTBLR21idEkwc2c5OERjazFTNzRxNkFmSFNOS3NqblJZOWUzdjlFeDZHTWZ5a1JTd1pOMStXNFlJZE1GM1gzd29Sc2lENA0KaHNJSkdyWDdNWDRMYkJKaDdnaWNnSmZ4aXhldk0vR0hjeHI3b29YWm5URDE0bnRlVitpLzRNVmNqcmxHS2cxL2JNOHBrcnBPOVdvUQ0KejdHR3RQWXB4bWFWMEhCck5mZ2N3R0xURFExZUpER3Y3Q2RIYkpXRnRMZFB4MnVrMlNpcWlxOTk1RUcwOG9RUFQvbHk5TnZ1NGxmKw0KcURZZkVRejRkRk1jc0JuRFBaYm41QXFqYnpPUFJOODUxUGNpWkI0VUtENEE0ZHh6Q243YkNybFc1WHI2S3h4ZUpWd3FPeDFtUHNKRw0KWnpDYXdiYzBEUVpxcE02R3Q4Mzd2ek1lamR6OHB1anR0VXY1a3E0dytUVGNZbHQrSkJWcGtjckZKR25oaVlxWnloZGpQTDJvZWlHUg0KS3pMSFh6YllHZndjVFV4RFp5Sm0vMUpTL0JzaE0zTTlkWlF3RlpSSGEra1ZwQnlkQVkyVkR3TUhkKzU3NEd1dWMvcjN1aFd5WXB2aA0KdDhZQ2pDWVBvSlM5MllxZlZMbUcvT3M3WUUwMkZ2bmN0YUMzSEN0aW9JS1BXOEp4YVhqV3RNejlnY0lheDNkakdzc2dDUFhHbC9FaQ0KWllSNlRoaEp6bWhPMTkrL28zRUh4TE8yVDB3dnFOckFOdVZucGpzMWlnSFJJVGQvWW1OaU4wbnREaTVBT3RpeU9kd094Nis5YlhGeg0KM0kvenU1TjJTTWhjWmJzQWkzb1A5bGFPdW9XOUNZaTd5NVErMklSYVpSVHJYdk1hbGE3Z29GK3V6RkZqaENWL2RsRE1jdjRjbFljaw0KNmhrQTU3Ry9BQUZ3L2E3WTN4TDVqU3Vaa2ZTVG1VVnM0K1hNdlg4UmsvZWVqYmJTcnB3Y1UyZ2RWeDhiTDBIK21SZEg0NFBJbkF4cA0KNjlJSzRRSHMvY1J6MThBYXZyYXJIUUNVdnpIMHNTSUZ5VnVRdWRYUzJMNittdHp1SDRtQ3p1RHUyNGhZdGtnSU9QUGFLWk5vZFhyTA0KU0xHUmlaa09RU0hCMGxueVNhcW9NbTVEWXRHMktiMDh6em5VUk16WENSK2l5dWw1SllrQllPY0tFZHVDVlVZOU5aTkszYW5BYy9GQQ0Kc2dPd1NOU0JuVVpyazlWaW9sSkorSmJHWXkrNTlwOVNoTWNwd2VkVFJqbElHaHF3UUtVVGJORTRKS3BxNFBBdDF4N3Q0c21pUkQ2MA0KQzlsZ1BuUFhrSzNxMy9IU1JFT3JvOUpocHBNMWUvQUFjUkhNUlNCbFJqUDF0NFllVmNRTVh0cWdHNXZxc3N2VmxxRllGMHp4c3FJeg0KdUVYL3lCNHlaVEptenZEeE1uVy9USXkwZFdMR3JYaklvQ1pDZ01YQjhTRFNhd2ZhM2hVZzFlczBQYjh5QWhTZHdMbml3aFFvZW1PeQ0Kd2JTTkEydGNnbUs4ODN5WkRweldSNXpiV3BzeGNJZzJCeUJqWERmNURaU1ZnVzBVeENLRitKZnU1U09pTG1hTFAvcVF1U092SUVKNQ0Kbk84bjRGdGp5c3FhbXRONnExMGprVDY5cllrSjg1bHM5YzNadzdpOGw1bTdoWUZHUWhzMHI3UGMyZG1qM3hNOVNnbHBTclBGa3pFVQ0Kd09xeHVGMFp6bHluc3RvU1Q4c1NiZHVhc0VuQUlaYzkyRUYxSjlKSUhJcy9xUnViV2xrUXhBdVgzWVJ3bzJSU2V1azJjbTJSOFZLeA0KdEJ2UEVuNjFuQnB2dXJvdWZnRkpzUkdIL0UyRFVtR2hQVnFPSWpmZ2RUN0hvdE5leU5HYUE0Z1hteUVvUmYxU1FJbW5ULytPcTZRVg0KYVkzdDlvNDRjWmtiWXQyVnl6anNuQUhlR3lUbXE1bVc5cHRPTWNsMjhWbFNBUXppdEN4Uk1pTlBraHpNWlJDNEdtblAxcFlHZThubA0KMmg3K0VTRU9oZ3M9PC94ZW5jOkNpcGhlclZhbHVlPjwveGVuYzpDaXBoZXJEYXRhPjwveGVuYzpFbmNyeXB0ZWREYXRhPjwvc2FtbDI6RW5jcnlwdGVkQXNzZXJ0aW9uPjwvc2FtbDJwOlJlc3BvbnNlPg==\""
write header "Connection" "Upgrade"
write header "Sec-WebSocket-Key" ${key}
write header "Sec-WebSocket-Version" "13"


read status "101" /.+/
read version "HTTP/1.1"
read header "Upgrade" /(?i:websocket)/
read header "Connection" /(?i:Upgrade)/
read header "Sec-WebSocket-Accept" ${ws:handshakeHash(key)}

write [0x82 0x7d]
write ${client125}

read [0x88 0x02 0x03 0xea]